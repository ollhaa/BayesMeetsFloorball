{
  "articles": [
    {
      "path": "about.html",
      "title": "About this site",
      "description": "Some additional details about the website",
      "author": [],
      "contents": "\n\n\n\n",
      "last_modified": "2025-01-15T13:32:20+02:00"
    },
    {
      "path": "index.html",
      "title": "Bayes Meets Floorball: How to Evaluate Shooting Percentages?",
      "description": "Estimating shooting percentages by using prior information. Also some predictions.",
      "author": [
        {
          "name": "Olli Haapasalo",
          "url": {}
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nBackground\nObserved Shooting Percentages\nBayesian Way\n\nAdjusted Shooting Percentages\nTop 10: Adjusted Percentage\nTop 10: Raw Percentages with Adjustment\nSome Excerpts From the Data\n\nPredictions\nModel\nTop 10: Top Scorers After Season\n\nDiscussion\n\nThe idea for this blog came from the desire to combine floorball and data analysis and learn a little bit about web scraping. The methods are mainly from the Variance Explained blog. I also noticed that the same idea has been used before by Ilari Scheinin. My own added value is to apply this to floorball, do explanatory data analysis and predict the final number of goals scored by each player.\nThe data is from F-liiga webpage and was obtained by web scraping.F-liiga is the highest level of floorball in Finland.\nBackground\nAfter Finland’s World Cup gold, interest in the domestic league has not diminished at all. Most of the star players of the Finnish national team, such as Justus Kainulainen, Aaro Astala, Joona Rantala and Otto Lehkosuo play in the F-Liiga. The public’s interest is often focused on points and goals, so in this article I will discuss goal scoring in a slightly nerdy way.\nAs 6.1.2025 a little more than half of the season has been played in the F-Liiga and the situation regarding the top scorers is as follows:\n\nTable 1: Top 10 Goal Scorers in F-liiga 6.1.2025\nPLAYER\nTEAM\nGames\nShots\nGoals\nGPG\nShooting%\nLastikka Ville\nClassic\n19\n116\n23\n1.21\n19.83\nAstala Aaro\nOilers\n13\n124\n22\n1.69\n17.74\nLaakso Mikko\nKrP\n15\n88\n22\n1.47\n25.00\nKainulainen Justus\nOilers\n16\n181\n21\n1.31\n11.60\nSalmi Markus\nOilers\n18\n108\n19\n1.06\n17.59\nSalokangas Tiitus\nClassic\n15\n73\n19\n1.27\n26.03\nÄijälä Eemil\nJymy\n19\n197\n19\n1.00\n9.64\nVaarala Karri\nJymy\n15\n139\n18\n1.20\n12.95\nHakanen Riku\nSPV\n18\n131\n17\n0.94\n12.98\nSalin Eemeli\nClassic\n17\n101\n17\n1.00\n16.83\n\nThe goal statistics is led by Lastikka Ville with 23 goals. In addition to the names and the number of goals, attention may be drawn to the key figures GPG which describes the number of goals per game and Shooting%. Shooting percentage means how many goals a player has scored with his number of shots. It is noted that the number of goals in a game can be divided into the number of shots and the shooting percentage:\n\\[ GPG =  SPG * Shooting\\%\\] Which can be written in more simplified form:\n\\[ {Goals \\over{Games}} =  {Shots \\over {Games}} * {Goals \\over {Shots}} \\] One way to model scoring is applied above by Binomial distribution. Binomial distribution is probability distribution which describes of the number of successes in a sequence of \\(n\\) independent experiments. There are two parameters in the model, \\(n\\) and \\(p\\). In here we can make assumption that \\(n\\) is shoots per game (SPG) and \\(p\\) is the shooting percentage (Shooting%). Index \\(i ∈ 1,2,...k\\) where \\(k\\) is number of players.\n\\[Goals\\ of\\ player_i\\ in\\ the\\ game = Binomial(SPG_i, Shooting_i\\%)\\]\nShooting percentage tells you how effectively a player takes advantage of scoring opportunities. For example, if a player has only four shots and has scored twice, their shooting percentage is 50.0% (or 0.50 as a decimal). However, it is difficult to answer how effectively a player shoots with four shots as more games accumulate, when randomness affects scoring. A player whose shooting percentage is the same 50.0% after a thousand shots is in some sense more credible.\nObserved Shooting Percentages\n\nTable 2: The Highest Shooting Percetages\nPLAYER\nTEAM\nGames\nShots\nGoals\nGPG\nShooting%\nTuominen Sami\nFBC\n2\n1\n1\n0.50\n100.00\nMäenpää Eero\nJymy\n9\n4\n2\n0.22\n50.00\nAlkki Lauri\nKrP\n14\n5\n2\n0.14\n40.00\nKantonen Kasperi\nTPS\n18\n3\n1\n0.06\n33.33\nLiponen Vili\nKrP\n15\n19\n6\n0.40\n31.58\nHietaranta Ville\nClassic\n18\n35\n10\n0.56\n28.57\nOrdning Aapo\nFBC\n17\n11\n3\n0.18\n27.27\nKauppila Oskari\nJymy\n18\n37\n10\n0.56\n27.03\nNiemelä Oliver\nTPS\n11\n15\n4\n0.36\n26.67\nSalokangas Tiitus\nClassic\n15\n73\n19\n1.27\n26.03\n\nAt the time of writing, the highest shooting percentage in the F-League is Tuominen Sami, which has 10^{4}%. Impressive percentages on the list, but how should we think about this when we notice that there are often quite a few shots? Next, we will briefly review the foundation of Bayesian statistics, the Bayesian formula.\nBayesian Way\nThe Bayesian approach is the second major paradigm in statistics, with a history dating back to the 18th century. The Bayesian approach has been controversial because it makes inference subjective. Two people with very different preconceptions about something can disagree even though evidence has been found. However, in recent decades, the Bayesian approach has become more common as computers have become more powerful. The approach is particularly effective when there is little data but a broad preconception about something.\nThe Bayesian approach thus involves combining prior knowledge with observations. Prior knowledge can be based on previous research or just one’s own preconceptions about the matter. Formally, Bayes’ theorem can be stated as follows:\n\\[P(\\theta|data)= {P(data|\\theta)P(\\theta) \\over P(data)}\\] Where:\n\\(P(\\theta|data)\\) Is posterior probability which means the distribution of the parameter after taking into account the observed data.\\(P(data|\\theta)\\) Is the likelihood, measures how well a statistical model explains observations.\\(P(\\theta)\\) Is prior distribution what means the distribution of the parameter before any data is observed.\\(P(data)\\) Is “evidence”. The marginal likelihood is the distribution of the observed data marginalized over the parameter.\nSome simplified examples can be found from here.\nAdjusted Shooting Percentages\n\n\n\nWe note that in our situation we could utilize a Bayesian approach to shooting percentages. The biggest challenge and sophistication of the Bayesian approach is to combine past data with observations. Often analytical solutions are not available, so the posterior probabilities must be estimated by simulation. This is one reason why the widespread use of computers has contributed to the popularity of Bayesian methods.\nThe first question is, what kind of shooting percentages we could use as a priori probabilities. We use Empirical Bayes’ estimation based on the prior distribution from the data itself. By looking at current F-League players with a total of at least 15 shots, we get some kind of estimate. Before the season we were able to utilize the data from the previous season. We notice that the mean of the data is 0.114 or 11.4 % , but there are lower and higher values in the distribution. One alternative to the prior distribution is the Beta distribution, which offers a flexible alternative for modeling with appropriate parameter choices.\n\\[Shooting\\% = Beta(\\alpha, \\beta)\\]\nThe Method of Moments or the Maximum Likelihood can be used to obtain estimates for the parameters \\(\\alpha\\) and \\(\\beta\\) from the prior data (this is called Emprical Bayes, which means that prior estimates is also comes from data). It is worth noting that my choice of prior distribution could also have been something else - this is what subjectivity means! We know that Beta-distribution has the following attributes:\n\\[{E(Shooting\\%) = } { \\alpha \\over{\\alpha+ \\beta}}\\]\nand\n\\[ {Var(Shooting\\%) = } {\\alpha\\beta \\over{(\\alpha + \\beta)^2(\\alpha+\\beta+1)}}\\]\nBy using Method of Moments we get estimates for \\(\\alpha\\) is 3.02 and for \\(\\beta\\) is 23.4. We can also check that first equation above holds: 0.114 \\(= \\alpha/(\\alpha+\\beta)\\) . Another advantage of choosing the beta distribution as the prior is that we can avoid difficult calculations and simulation at this point. Let us next consider two imaginary players with the same observed shooting percentage but different numbers of shots. The posterior mean for shooting percentage is:\n\\[ {Adjusted\\ Shooting\\%\\ of\\ player_i = } { \\alpha + Goals_i\\  \\over { \\alpha + Shots_i + \\beta }}\\]\nIf Player 1 has taken 100 shots in a season and scored 20 times, then his shooting percentage is 0.2, or 20%, based on observations, but adjusted with the prior information 0.182 or 18.2%. Correspondingly, Player 2, who has only taken 10 shots and scored twice, has the same observed shooting percentage, but adjusted 0.138 or 13.8%! It is worth noting that the adjusted estimate approaches the estimates based on the player’s observations as the number of observations increases. In summary, it can be said that the player’s adjusted estimate for shooting percentage scales in a way that higher-than-average observed values are still higher as a priori estimates and vice versa. The evidence, i.e. the number of shots affects how strongly this happens.\n\n\n\nIn the image above, the gray histogram of the shooting percentages (with binwidth = 0.01) and the black curve is the Beta distribution with parameters \\(\\alpha =\\) 3.02 and \\(\\beta =\\) 23.4 estimated from the data.\nTop 10: Adjusted Percentage\nNext, let us look at what the adjusted shooting% looks like for the best players:\n\n\n\n\n\n\nThe first one on the list is “r eb1”, whose uncorrected (gray) shooting percentage is 26.03 and adjusted (black) is 22.52. We notice that for some players on the list there is a difference between the adjusted and uncorrected percentages.\nTop 10: Raw Percentages with Adjustment\nNext, let us see how the top 10 adjusted shooting percentages change from uncorrected shooting percentages:\n\n\n\n\n\n\nThe first on the list is of course still (see Table 2) Tuominen Sami, whose uncorrected (gray) shooting percentage is 100% and corrected (black) 14.92%. We notice that for some of the players on the list the difference between adjusted and uncorrected is really big. More evidence i.e. shots is needed for them!\nSome Excerpts From the Data\n\n\n\nIn this section, I will take some excerpts from the data. I will create five different segments for both the number of shots and the adjusted shooting percentage, so 5*5 = 25 segments in total. The limits are based on a quantile function, also known as the inverse of the cumulative function, and it tells you the limit below which the proportion in question falls. The limits are 0.3, 0.5, 0.7, and 0.9. For example, for the number of shots per game, the limit of 0.9 is “r rounded_limit_lo_limit_09”, meaning that 90% of players have a number of shots per game below this.\n\n\n\nI have highlighted two different groups in the image above. On the top right (light green) are players who have both an adjusted shooting percentage and shots per game in the top 10%. On the bottom right (red) are players who have a shot per game in the top 10% but an adjusted shooting percentage in the bottom 30%.\n\nTable 3: F-liiga 2024-25: Adjusted Shooting Percentage and Shots Per Game in the Highest Class\nPLAYER\nTEAM\nGames\nShots\nGoals\nGPG\nAdjusted%\nAstala Aaro\nOilers\n13\n124\n22\n1.69\n16.73\nLastikka Ville\nClassic\n19\n116\n23\n1.21\n18.42\nSalmi Markus\nOilers\n18\n108\n19\n1.06\n16.48\nLaakso Mikko\nKrP\n15\n88\n22\n1.47\n22.18\nRantala Joona\nKrP\n15\n88\n16\n1.07\n16.75\n\nThere are well-known goal scorers on the list whose shooting skills are known. But for example, the best player in the world, Justus Kainulainen, does not make it into the top ten. On the other hand, with the number of shots Kainulainen takes it is very difficult to keep the shooting percentage above 11 percent. What is a potential goal scoring spot for one person is not for another.\nPredictions\nCan we then use the data in some way if our goal was to predict the winner of the goal statistics? This may be possible, but it hardly provides any specific information for the sport fanatics. It may even be that the predicted number of goals will be slightly too low due to the adjustment for shooting percentages. However, one option is to use the number of shots and the remaining matches in addition to the player-specific adjustment percentages.\nModel\n\\[Goals_i\\ after \\ season = Goals \\ now_i\\ + \\sum^{j_i}_{j_i=0} Binomial(SPG_i, Adjusted\\ Shooting_i\\%)\\]\nWhere:\n\\[SPG_i = Poisson(\\lambda_i)\\]\n\\[ Adjusted\\ Shooting\\%_i =  Beta(\\alpha_i, \\beta_i)\\]\nAnd:\n\\[\\lambda_i\\ = Shots\\ of\\ Player_i / Games\\ of\\ Player_ii\\]\n\\[\\alpha_i\\ = \\alpha + Goals\\ of\\ player_i\\]\n\\[\\beta_i\\ = \\beta + Shots\\ of\\ player_i\\].\nIndex \\(i ∈ 1,2,...k\\) where k is number of players and index \\(j ∈ 0,1,...33\\) describes the number of games left of players \\(i\\) team.\nOur model is based on the following assumptions:\n-The player’s shooting percentage follows a Beta distribution (see section: “Adjusted Shooting Percentages”). The adjusted shooting percentage is therefore the expected value of this posterior distribution.\n-The player’s shooting rate in a game is assumed to be Poisson distributed with a parameter \\(\\lambda_i\\). As is well known, the expected value and variance of a Poisson distribution are equal. The estimate for \\(\\lambda_i\\) is the sample mean \\(Shots_i/Games_i\\). In the same way as for shooting percentages, we could also correct for shooting numbers but since our goal is to predict the winner of the goal statistics, we will not do this (we assume that their shooting percentages are plausible estimates of how many shots they will have in future games).\n-The player’s remaining games in the season is a fixed amount 33 minus the team’s remaining games. We could also think of this as a random variable, but we won’t do that here.\nTop 10: Top Scorers After Season\n\n\n\nFinally, we can make predictions. We simulate the number of goals scored by each player. In the image below, the black arrow represents the number of goals scored at the moment, the square is the point estimate for the final number of goals scored, and the gray line represents the range where 80 percent of the simulated goals are located.The winner of goal statistics will be Astala Aaro with 42. 80 percent of simulations locates between 37 and 48.\n\n\n\nDiscussion\nAbove I have presented a model that can be used to estimate shooting percentages when there are few observations. The approach is easy to understand and intuitive.\nIn the case of a small sport, data quality can be a challenge. However, segmenting players based on corrected shooting percentage and number of shots can offer the opportunity to focus on specific players.\nThe presented model for predicting final goal totals includes some implicit and explicit assumptions that can be discussed. For example, the assumption that every player plays the remaining games is not plausible, but correcting this is challenging. However, based on the player’s injury history, this might be possible to take into account. The player’s shooting percentage in the game was also assumed to be Poisson distributed with a fixed parameter.\nHowever, one strength of the model is that the difference between the predicted goal total and the actual goal total approaches zero as the number of games played increases. As I mentioned earlier, due to the correction of shooting percentages, the predicted goal numbers for top players may be slightly too low. This is especially true for players who shoot few but very effectively. This could be taken into account by also including previous seasons.\nAs the saying goes, “all models are wrong, but some are useful”.\n\n\n\n",
      "last_modified": "2025-01-15T14:20:34+02:00"
    }
  ],
  "collections": []
}
